<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Entrar — Magaxia</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background: radial-gradient(circle at top, #4da3ff, #003bff 60%, #001a66);
  color:#000;
  backdrop-filter:blur(5px);
}

/* fundo brilho */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 30% 20%, rgba(255,255,255,0.35), transparent 60%),
    radial-gradient(circle at 80% 70%, rgba(255,255,255,0.20), transparent 70%);
  filter:blur(40px);
  pointer-events:none;
}

/* card */
.box{
  width:350px;
  margin:40px auto;
  background:rgba(255,255,255,0.35);
  padding:20px;
  border-radius:12px;
  box-shadow:0 6px 20px rgba(0,0,0,.3);
  backdrop-filter:blur(10px);
}

/* inputs */
input{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:8px;
  border:none;
  background:rgba(255,255,255,0.65);
  color:#000;
  font-size:15px;
}

/* botões */
button{
  width:100%;
  padding:12px;
  background:#4da3ff;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
  color:#000;
  margin-top:6px;
}
button:hover{
  background:#2eb4ff;
}

/* alternar login / cadastro */
.link{
  text-align:center;
  margin-top:10px;
  cursor:pointer;
  color:#000;
  font-weight:bold;
}

/* mensagem */
.msg{
  display:none;
  text-align:center;
  padding:10px;
  margin-bottom:10px;
  border-radius:8px;
  background:#00ff88;
  color:#000;
}
</style>
</head>
<body>

<div class="box">

  <h2 id="titulo">Entrar</h2>

  <div id="msg" class="msg"></div>

  <!-- LOGIN -->
  <div id="loginBox">
    <input id="loginUser" type="text" placeholder="Usuário">
    <input id="loginPass" type="password" placeholder="Senha">
    <button id="btnLogin">Entrar</button>
    <div class="link" onclick="mostrarCadastro()">Criar conta</div>
  </div>

  <!-- CADASTRO -->
  <div id="cadastroBox" style="display:none;">
    <input id="regUser" type="text" placeholder="Usuário">
    <input id="regPass" type="password" placeholder="Senha">
    <input id="regConvite" type="text" placeholder="Código de convite">

    <button id="btnRegister">Cadastrar</button>
    <div class="link" onclick="mostrarLogin()">Já tenho conta</div>
  </div>

</div>

<script type="module">

/* -------------------------------
   IGNORAR NEXT — MAS LER CODIGO DE CONVITE
--------------------------------*/
const params = new URLSearchParams(window.location.search);
let codigoConvite = params.get("codigo") || "";

if (codigoConvite) {
    document.getElementById("regConvite").value = codigoConvite;
}

/* alternar telas */
function mostrarCadastro(){
  document.getElementById("loginBox").style.display = "none";
  document.getElementById("cadastroBox").style.display = "block";
  document.getElementById("titulo").innerText = "Criar Conta";
}
function mostrarLogin(){
  document.getElementById("cadastroBox").style.display = "none";
  document.getElementById("loginBox").style.display = "block";
  document.getElementById("titulo").innerText = "Entrar";
}

/* mostrar mensagens */
function showMessage(txt){
  let m = document.getElementById("msg");
  m.innerText = txt;
  m.style.display = "block";
  setTimeout(()=>{ m.style.display="none"; }, 2000);
}

/* -------------------------------
   LOGIN — SEMPRE VAI PARA INDEX
--------------------------------*/
document.getElementById("btnLogin").onclick = () => {

    let u = document.getElementById("loginUser").value.trim();
    let p = document.getElementById("loginPass").value.trim();

    let data = JSON.parse(localStorage.getItem("magaxia_users") || "{}");

    if (!data[u] || data[u].senha !== p) {
        showMessage("Usuário ou senha incorretos!");
        return;
    }

    localStorage.setItem("vast_logged","1");
    localStorage.setItem("vast_user",u);

    // Redirecionar sempre para index
    window.location.href = "index.html";
};

/* -------------------------------
   CADASTRO — LOGA E VAI PARA INDEX
--------------------------------*/
document.getElementById("btnRegister").onclick = () => {

    let u = document.getElementById("regUser").value.trim();
    let p = document.getElementById("regPass").value.trim();
    let conv = document.getElementById("regConvite").value.trim();

    if (!u || !p){
        showMessage("Preencha usuário e senha.");
        return;
    }

    let data = JSON.parse(localStorage.getItem("magaxia_users") || "{}");

    if (data[u]) {
        showMessage("Usuário já existe!");
        return;
    }

    data[u] = { senha:p, convite:conv };
    localStorage.setItem("magaxia_users", JSON.stringify(data));

    // loga automaticamente
    localStorage.setItem("vast_logged","1");
    localStorage.setItem("vast_user",u);

    showMessage("Conta criada!");

    setTimeout(()=>{
        window.location.href = "index.html";
    }, 700);

};
</script>

</body>
</html>
