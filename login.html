<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KALEBI SDC CAPITAL • Login / Cadastro</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{
  --bg1:#030416;
  --bg2:#001025;
  --glass-border: rgba(255,255,255,0.06);
  --muted: rgba(255,255,255,0.6);
}
*{box-sizing:border-box;}
html,body{
  height:100%;
  margin:0;
  font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto;
  background:
    radial-gradient(1200px 600px at 10% 10%, rgba(15,30,60,0.5), transparent 10%),
    linear-gradient(180deg,var(--bg1), var(--bg2));
  color:#e6f7ff;
  display:flex;
  align-items:center;
  justify-content:center;
}
.container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:60px;}
.card{
  width:420px;max-width:90vw;padding:46px;border-radius:28px;
  background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03);
  box-shadow:0 30px 80px rgba(0,0,0,0.6);
}
.brand{text-align:center;margin-bottom:18px;}
.brand img{width:120px;margin-bottom:10px;}
.brand h1{
  margin:0;font-size:40px;font-weight:800;
  background:linear-gradient(180deg,#fff3b0,#ffd700,#c9a227);
  -webkit-background-clip:text;color:transparent;
}
.subtitle{margin:16px 0;font-size:22px;color:var(--muted);text-align:center}
.form{display:flex;flex-direction:column;gap:14px;}
.field{position:relative;padding:14px 16px 14px 50px;border-radius:14px;border:1px solid var(--glass-border);}
.field input{width:100%;background:none;border:0;outline:0;color:#fff;}
.field .icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);}
.btn{
  padding:16px;border-radius:16px;border:0;font-weight:800;cursor:pointer;
  background:linear-gradient(90deg,#00f0ff,#9b4cff);
}
.secondary{text-align:center;margin-top:12px;color:#7de9ff;text-decoration:none;display:block;}
.small-note{font-size:12px;color:rgba(255,255,255,.5);margin-top:8px;text-align:center;}
.toast{
  position:fixed;top:20px;left:50%;transform:translateX(-50%);
  padding:10px 16px;border-radius:10px;color:#fff;z-index:9999;
}
</style>
</head>

<body>
<div class="container">
<div class="card">

<div class="brand">
  <img src="logo-magaxia.png">
  <h1>KALEBI SDC CAPITAL</h1>
</div>

<!-- LOGIN -->
<div id="loginBox">
  <div class="subtitle">Entrar</div>
  <div id="prefillNotice" class="small-note" style="display:none"></div>
  <form id="loginForm" class="form">
    <label class="field"><span class="icon"><i class="fa fa-phone"></i></span>
      <input id="phone" type="tel" placeholder="Telefone" required></label>
    <label class="field"><span class="icon"><i class="fa fa-lock"></i></span>
      <input id="password" type="password" placeholder="Senha" required></label>
    <button class="btn" type="submit">Entrar</button>
  </form>
  <a href="#" id="linkCreate" class="secondary">Criar conta</a>
</div>

<!-- CADASTRO -->
<div id="registerBox" style="display:none">
  <div class="subtitle">Criar Conta</div>
  <form id="registerForm" class="form">
    <label class="field"><span class="icon"><i class="fa fa-user"></i></span>
      <input id="r_name" placeholder="Nome completo" required></label>
    <label class="field"><span class="icon"><i class="fa fa-phone"></i></span>
      <input id="r_phone" placeholder="Telefone" required></label>
    <label class="field"><span class="icon"><i class="fa fa-lock"></i></span>
      <input id="r_pass" type="password" placeholder="Senha" required></label>
    <label class="field"><span class="icon"><i class="fa fa-tag"></i></span>
      <input id="inviteCodeReg" placeholder="Código de convite (opcional)"></label>
    <button class="btn" type="submit">Registrar</button>
  </form>
  <div class="small-note">Código gerado: <span id="generatedCode">—</span></div>
  <a href="#" id="linkHaveAccount" class="secondary">Já tenho conta</a>
</div>

</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyAcVPgUHbL4N9U1-H68klmGKWQF-YGleyc",
  authDomain:"vastbitloud-2872a.firebaseapp.com",
  projectId:"vastbitloud-2872a"
};

let db=null;
try{initializeApp(firebaseConfig);db=getFirestore();}catch{}

function toast(msg,ok=true){
  const t=document.createElement('div');
  t.className='toast';
  t.style.background=ok?'#2ecc71':'#ff4d4d';
  t.textContent=msg;
  document.body.appendChild(t);
  setTimeout(()=>t.remove(),2200);
}

function switchToRegister(){loginBox.style.display='none';registerBox.style.display='block';}
function switchToLogin(){registerBox.style.display='none';loginBox.style.display='block';}

loginForm.addEventListener('submit',e=>{
  e.preventDefault();
  const s=JSON.parse(localStorage.getItem('vast_userdata')||'null');
  if(s && s.phone===phone.value && s.pass===password.value){
    localStorage.setItem('vast_logged','1');
    toast('Login realizado');
    setTimeout(()=>location.href='index.html',700);
  }else toast('Telefone ou senha incorretos',false);
});

registerForm.addEventListener('submit',async e=>{
  e.preventDefault();
  const code='VAST-'+Date.now().toString(36).toUpperCase();
  const data={user:r_name.value,phone:r_phone.value,pass:r_pass.value,myCode:code,invitedBy:inviteCodeReg.value||null};
  localStorage.setItem('vast_userdata',JSON.stringify(data));
  localStorage.setItem('vast_logged','1');
  generatedCode.textContent=code;
  if(db) try{await addDoc(collection(db,'users'),data);}catch{}
  toast('Conta criada');
  switchToLogin();
});

linkCreate.onclick=e=>{e.preventDefault();switchToRegister();}
linkHaveAccount.onclick=e=>{e.preventDefault();switchToLogin();}

const p=new URLSearchParams(location.search);
const inv=p.get('codigo')||p.get('invite');
if(inv){inviteCodeReg.value=inv;prefillNotice.textContent='Código detectado: '+inv;prefillNotice.style.display='block';}
</script>
</body>
</html>
